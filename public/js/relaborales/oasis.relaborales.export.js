function exportarReporte(e){columna=new Object,filtros=new Object,agrupados=new Object,ordenados=new Object,ubicacion=$("#jqxgrid").jqxGrid("getcolumn","ubicacion"),condicion=$("#jqxgrid").jqxGrid("getcolumn","condicion"),estado_descripcion=$("#jqxgrid").jqxGrid("getcolumn","estado_descripcion"),tiene_contrato_vigente_descripcion=$("#jqxgrid").jqxGrid("getcolumn","tiene_contrato_vigente_descripcion"),nombres=$("#jqxgrid").jqxGrid("getcolumn","nombres"),ci=$("#jqxgrid").jqxGrid("getcolumn","ci"),expd=$("#jqxgrid").jqxGrid("getcolumn","expd"),edad=$("#jqxgrid").jqxGrid("getcolumn","edad"),genero=$("#jqxgrid").jqxGrid("getcolumn","genero"),fecha_nac=$("#jqxgrid").jqxGrid("getcolumn","fecha_nac"),fecha_cumple=$("#jqxgrid").jqxGrid("getcolumn","fecha_cumple"),gerencia_administrativa=$("#jqxgrid").jqxGrid("getcolumn","gerencia_administrativa"),cargo=$("#jqxgrid").jqxGrid("getcolumn","cargo"),sueldo=$("#jqxgrid").jqxGrid("getcolumn","sueldo"),departamento_administrativo=$("#jqxgrid").jqxGrid("getcolumn","departamento_administrativo"),area=$("#jqxgrid").jqxGrid("getcolumn","area"),fin_partida=$("#jqxgrid").jqxGrid("getcolumn","fin_partida"),proceso_codigo=$("#jqxgrid").jqxGrid("getcolumn","proceso_codigo"),nivelsalarial=$("#jqxgrid").jqxGrid("getcolumn","nivelsalarial"),fecha_ing=$("#jqxgrid").jqxGrid("getcolumn","fecha_ing"),fecha_ini=$("#jqxgrid").jqxGrid("getcolumn","fecha_ini"),fecha_incor=$("#jqxgrid").jqxGrid("getcolumn","fecha_incor"),fecha_fin=$("#jqxgrid").jqxGrid("getcolumn","fecha_fin"),fecha_baja=$("#jqxgrid").jqxGrid("getcolumn","fecha_baja"),motivo_baja=$("#jqxgrid").jqxGrid("getcolumn","motivo_baja"),antiguedad=$("#jqxgrid").jqxGrid("getcolumn","antiguedad"),observacion=$("#jqxgrid").jqxGrid("getcolumn","observacion"),columna[ubicacion.datafield]={text:ubicacion.text,hidden:ubicacion.hidden},columna[condicion.datafield]={text:condicion.text,hidden:condicion.hidden},columna[estado_descripcion.datafield]={text:estado_descripcion.text,hidden:estado_descripcion.hidden},columna[tiene_contrato_vigente_descripcion.datafield]={text:tiene_contrato_vigente_descripcion.text,hidden:tiene_contrato_vigente_descripcion.hidden},columna[nombres.datafield]={text:nombres.text,hidden:nombres.hidden},columna[ci.datafield]={text:ci.text,hidden:ci.hidden},columna[expd.datafield]={text:expd.text,hidden:expd.hidden},columna[genero.datafield]={text:genero.text,hidden:genero.hidden},columna[edad.datafield]={text:edad.text,hidden:edad.hidden},columna[fecha_nac.datafield]={text:fecha_nac.text,hidden:fecha_nac.hidden},columna[fecha_cumple.datafield]={text:fecha_cumple.text,hidden:fecha_cumple.hidden},columna[gerencia_administrativa.datafield]={text:gerencia_administrativa.text,hidden:gerencia_administrativa.hidden},columna[departamento_administrativo.datafield]={text:departamento_administrativo.text,hidden:departamento_administrativo.hidden},columna[area.datafield]={text:area.text,hidden:area.hidden},columna[proceso_codigo.datafield]={text:proceso_codigo.text,hidden:proceso_codigo.hidden},columna[fin_partida.datafield]={text:fin_partida.text,hidden:fin_partida.hidden},columna[cargo.datafield]={text:cargo.text,hidden:cargo.hidden},columna[sueldo.datafield]={text:sueldo.text,hidden:sueldo.hidden},columna[fecha_ing.datafield]={text:fecha_ing.text,hidden:fecha_ing.hidden},columna[fecha_ini.datafield]={text:fecha_ini.text,hidden:fecha_ini.hidden},columna[fecha_incor.datafield]={text:fecha_incor.text,hidden:fecha_incor.hidden},columna[nivelsalarial.datafield]={text:nivelsalarial.text,hidden:nivelsalarial.hidden},columna[fecha_fin.datafield]={text:fecha_fin.text,hidden:fecha_fin.hidden},columna[fecha_baja.datafield]={text:fecha_baja.text,hidden:fecha_baja.hidden},columna[motivo_baja.datafield]={text:motivo_baja.text,hidden:motivo_baja.hidden},columna[antiguedad.datafield]={text:antiguedad.text,hidden:antiguedad.hidden},columna[observacion.datafield]={text:observacion.text,hidden:observacion.hidden};var i=$("#jqxgrid").jqxGrid("groups");null!=i&&""!=i||(i="null");var d=$("#jqxgrid").jqxGrid("getsortinformation");if(null!=d.sortcolumn){var a=d.sortcolumn,t=d.sortdirection;ordenados[a]={asc:t.ascending,desc:t.descending}}else ordenados="";for(var n=$("#lstGestion").val(),o=$("#jqxgrid").jqxGrid("getrows"),r=$("#jqxgrid").jqxGrid("getfilterinformation"),c=0,l=0;l<r.length;l++)for(var x=r[l],g=x.filter.getfilters(),f=0;f<g.length;f++){0<f&&c++,filtros[l+c]={columna:x.filtercolumn,valor:g[f].value,condicion:g[f].condition,tipo:g[f].type}}var h=o.length,u=JSON.stringify(filtros),m=JSON.stringify(columna),_=JSON.stringify(ordenados);m=btoa(utf8_encode(m)),u=btoa(utf8_encode(u)),_=btoa(utf8_encode(_));var s=btoa(utf8_encode(i));m=m.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,""),u=u.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,""),s=s.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,""),_=_.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,"");var j="";switch(e){case 1:j="/relaborales/exportexcel/";break;case 2:j="/relaborales/exportpdf/"}""!=j&&window.open(j+h+"/"+n+"/"+m+"/"+u+"/"+s+"/"+_,"_blank")}function utf8_encode(e){if(null==e)return"";var i,d,a,t=e+"",n="";i=d=0,a=t.length;for(var o=0;o<a;o++){var r=t.charCodeAt(o),c=null;if(r<128)d++;else if(127<r&&r<2048)c=String.fromCharCode(r>>6|192,63&r|128);else if(55296!=(63488&r))c=String.fromCharCode(r>>12|224,r>>6&63|128,63&r|128);else{if(55296!=(64512&r))throw new RangeError("Unmatched trail surrogate at "+o);var l=t.charCodeAt(++o);if(56320!=(64512&l))throw new RangeError("Unmatched lead surrogate at "+(o-1));r=((1023&r)<<10)+(1023&l)+65536,c=String.fromCharCode(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}null!==c&&(i<d&&(n+=t.slice(i,d)),n+=c,i=d=o+1)}return i<d&&(n+=t.slice(i,a)),n}